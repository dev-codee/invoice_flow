{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign In — InvoiceFlow</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

  <!-- Design System -->
  <link rel="stylesheet" href="{% static 'css/invoiceflow.css' %}">
</head>
<body class="auth-body">

  <div class="auth-layout">

    <!-- Left panel: branding -->
    <div class="auth-panel-left">
      <div class="auth-panel-inner">
        <div class="auth-brand">
          <div class="auth-brand-logo">
            <i class="bi bi-receipt-cutoff"></i>
          </div>
          <div class="auth-brand-name">Invoice<span>Flow</span></div>
        </div>
        <h1 class="auth-panel-headline">Invoicing made&nbsp;<em>effortless.</em></h1>
        <p class="auth-panel-sub">One platform to create invoices, collect payments, and grow your business — all in one place.</p>

        <div class="auth-features">
          <div class="auth-feature-item">
            <div class="auth-feature-icon"><i class="bi bi-lightning-charge-fill"></i></div>
            <div>
              <div class="auth-feature-title">Instant Invoices</div>
              <div class="auth-feature-desc">Create and send professional invoices in seconds.</div>
            </div>
          </div>
          <div class="auth-feature-item">
            <div class="auth-feature-icon"><i class="bi bi-graph-up-arrow"></i></div>
            <div>
              <div class="auth-feature-title">Real-time Analytics</div>
              <div class="auth-feature-desc">Track revenue, overdue amounts, and cash flow.</div>
            </div>
          </div>
          <div class="auth-feature-item">
            <div class="auth-feature-icon"><i class="bi bi-shield-lock-fill"></i></div>
            <div>
              <div class="auth-feature-title">Secure Payments</div>
              <div class="auth-feature-desc">Stripe-powered, encrypted, and always reliable.</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right panel: form -->
    <div class="auth-panel-right">
      <div class="auth-form-wrap">
        <div class="auth-form-header">
          <h2 class="auth-form-title">Welcome back</h2>
          <p class="auth-form-sub">Sign in to your InvoiceFlow account</p>
        </div>

        {% if messages %}
        <div class="auth-alerts">
          {% for message in messages %}
          <div class="auth-alert auth-alert-{{ message.tags }}">
            <i class="bi {% if 'success' in message.tags %}bi-check-circle{% elif 'error' in message.tags %}bi-x-circle{% else %}bi-info-circle{% endif %}"></i>
            {{ message }}
          </div>
          {% endfor %}
        </div>
        {% endif %}

        {% if form.errors %}
        <div class="auth-alerts">
          {% for field in form %}
            {% for error in field.errors %}
            <div class="auth-alert auth-alert-error">
              <i class="bi bi-x-circle"></i>
              {% if field.label != 'Hidden' %}{{ field.label }}: {% endif %}{{ error }}
            </div>
            {% endfor %}
          {% endfor %}
          {% for error in form.non_field_errors %}
          <div class="auth-alert auth-alert-error">
            <i class="bi bi-x-circle"></i>
            {{ error }}
          </div>
          {% endfor %}
        </div>
        {% endif %}

        <form method="POST" action="{% url 'account_login' %}" class="auth-form" novalidate>
          {% csrf_token %}

          <div class="auth-field">
            <label class="auth-label" for="id_login">Email address</label>
            <div class="auth-input-wrap">
              <i class="bi bi-envelope auth-input-icon"></i>
              <input
                type="email"
                id="id_login"
                name="login"
                class="auth-input"
                placeholder="you@example.com"
                autocomplete="email"
                value="{{ form.login.value|default:'' }}"
                required
              >
            </div>
          </div>

          <div class="auth-field">
            <div class="auth-label-row">
              <label class="auth-label" for="id_password">Password</label>
              <a href="{% url 'account_reset_password' %}" class="auth-forgot-link">Forgot password?</a>
            </div>
            <div class="auth-input-wrap">
              <i class="bi bi-lock auth-input-icon"></i>
              <input
                type="password"
                id="id_password"
                name="password"
                class="auth-input"
                placeholder="••••••••"
                autocomplete="current-password"
                required
              >
              <button type="button" class="auth-input-toggle" onclick="togglePassword('id_password', this)" tabindex="-1" aria-label="Toggle password visibility">
                <i class="bi bi-eye"></i>
              </button>
            </div>
          </div>

          <div class="auth-remember">
            <label class="auth-checkbox-label">
              <input type="checkbox" name="remember" id="id_remember" {% if form.remember.value %}checked{% endif %}>
              <span class="auth-checkbox-custom"></span>
              Keep me signed in
            </label>
          </div>

          <input type="hidden" name="next" value="{{ next }}">

          <button type="submit" class="auth-submit-btn">
            <span>Sign In</span>
            <i class="bi bi-arrow-right"></i>
          </button>
        </form>

        <div class="auth-divider"><span>or</span></div>

        <div class="auth-footer-link">
          Don't have an account? <a href="{% url 'account_signup' %}">Create one free</a>
        </div>
      </div>
    </div>

  </div>

  <script>
    function togglePassword(fieldId, btn) {
      const input = document.getElementById(fieldId);
      const icon = btn.querySelector('i');
      if (input.type === 'password') {
        input.type = 'text';
        icon.className = 'bi bi-eye-slash';
      } else {
        input.type = 'password';
        icon.className = 'bi bi-eye';
      }
    }
  </script>
</body>
</html>
