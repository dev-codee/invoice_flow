{% extends 'base.html' %}
{% block title %}Record Payment — {{ invoice.invoice_number }}{% endblock %}
{% block content %}
<div class="page-header">
  <div class="page-header-left">
    <div style="display:flex;align-items:center;gap:12px;">
      <a href="{% url 'invoices:detail' invoice.pk %}" class="btn-icon" style="width:32px;height:32px;flex-shrink:0;text-decoration:none;"><i class="bi bi-arrow-left"></i></a>
      <div>
        <h1 class="page-title" style="margin-bottom:2px;">Record Payment</h1>
        <p class="page-subtitle" style="margin:0;">{{ invoice.invoice_number }} · {{ invoice.client.name }}</p>
      </div>
    </div>
  </div>
</div>

<div style="display:grid;grid-template-columns:1fr 300px;gap:20px;max-width:820px;align-items:start;">
  <div class="card">
    <div class="card-header"><h3 class="card-header-title">Payment Details</h3></div>
    <div class="card-body">
      <form method="post">
        {% csrf_token %}
        <div style="display:grid;gap:14px;">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;">
            <div>
              <label class="form-label">Amount *</label>
              {{ form.amount }}
              {% if form.amount.errors %}<div style="color:#ef4444;font-size:11.5px;margin-top:4px;">{{ form.amount.errors.0 }}</div>{% endif %}
            </div>
            <div>
              <label class="form-label">Payment Date</label>
              {{ form.payment_date }}
            </div>
          </div>
          <div>
            <label class="form-label">Payment Method</label>
            {{ form.method }}
          </div>
          <div>
            <label class="form-label">Reference / Note</label>
            {{ form.reference }}
          </div>
        </div>
        <div style="display:flex;gap:10px;margin-top:20px;">
          <button type="submit" class="btn btn-primary"><i class="bi bi-check2"></i> Record Payment</button>
          <a href="{% url 'invoices:detail' invoice.pk %}" class="btn btn-secondary">Cancel</a>
        </div>
      </form>
    </div>
  </div>

  <div class="card">
    <div class="card-body">
      <div style="margin-bottom:16px;">
        <div style="font-size:10.5px;font-weight:700;letter-spacing:0.8px;text-transform:uppercase;color:var(--text-muted);margin-bottom:12px;">Invoice Summary</div>
        <div style="display:flex;flex-direction:column;gap:8px;font-size:13px;">
          <div style="display:flex;justify-content:space-between;">
            <span style="color:var(--text-muted);">Invoice Total</span>
            <span style="font-weight:600;">${{ invoice.total|floatformat:2 }}</span>
          </div>
          <div style="display:flex;justify-content:space-between;">
            <span style="color:var(--text-muted);">Amount Paid</span>
            <span style="font-weight:600;color:#10b981;">${{ invoice.amount_paid|floatformat:2 }}</span>
          </div>
          <div style="display:flex;justify-content:space-between;padding-top:8px;border-top:2px solid var(--border);font-size:15px;">
            <span style="font-weight:700;">Balance Due</span>
            <span style="font-weight:800;color:#ef4444;">${{ invoice.balance_due|floatformat:2 }}</span>
          </div>
        </div>
      </div>
      <span class="status-badge status-{{ invoice.status }}" style="display:block;text-align:center;">{{ invoice.get_status_display }}</span>
    </div>
  </div>
</div>
{% endblock %}
